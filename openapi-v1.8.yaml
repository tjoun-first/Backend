openapi: 3.0.3
info:
  title: NewsMoa Backend API
  description: |
    NewsMoa Backend 서비스의 API 명세서입니다.
    기사 조회, 로그인, 마이페이지 기능을 제공합니다.
  version: 1.8.0
servers:
  - url: /api
    description: 기본 API 서버

paths:
  /login:
    post:
      summary: 로그인 API
      description: 입력한 ID와 PW로 로그인합니다.
      operationId: loginUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: 로그인 성공
        '400':
          description: 잘못된 요청 형식
        '401':
          description: 로그인 실패
  /users:
    post:
      summary: 회원가입
      description: 신규 사용자를 등록합니다.
      tags:
        - User
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - password
              properties:
                id:
                  type: string
                  example: user123
                password:
                  type: string
                  example: 1234
      responses:
        "201":
          description: 회원가입 성공
        "400":
          description: 입력값 오류
        "409":
          description: 아이디 중복

  /users/exists:
    get:
      summary: 아이디 중복 체크
      description: 입력한 로그인 아이디의 중복 여부를 확인합니다.
      tags:
        - User
      parameters:
        - name: loginId
          in: query
          required: true
          description: 중복 확인할 로그인 ID
          schema:
            type: string
            example: user123
      responses:
        "200":
          description: 조회 성공
        "400":
          description: 요청 파라미터 누락
          

  /article/{category}:
    get:
      summary: 기사 목록 조회
      description: 입력한 카테고리에 해당하는 기사들의 목록(title, id 등)을 반환합니다. content, simplified, summary는 null일 수 있습니다.
      tags:
        - Article
      operationId: getArticlesByCategory
      parameters:
        - name: category
          in: path
          description: 한글로 된 기사 카테고리 이름 (경제, 과학, 사회, 세계, 문화)
          required: true
          schema:
            type: string
            enum:
              - 경제
              - 과학
              - 사회
              - 세계
              - 문화
      responses:
        '200':
          description: 기사 목록 반환 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Article'

  /article/id/{article_id}:
    get:
      summary: 기사 세부정보 조회
      description: 요청한 article_id의 모든 상세 정보를 반환합니다.
      tags:
        - Article
      operationId: getArticleDetail
      parameters:
        - name: article_id
          in: path
          description: 조회할 기사 ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 기사 세부 정보 반환 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Article'
        '400':
          description: 잘못된 article_id 입력

  /mypage/scraped:
    get:
      summary: 마이페이지 - 스크랩한 기사 목록
      description: 요청한 유저가 스크랩한 기사 리스트를 반환합니다. (세션 기반 인증)
      tags:
        - Mypage
      operationId: getScrapedArticles
      responses:
        '200':
          description: 스크랩 기사 목록 반환
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Article'
    put:
      summary: 기사 스크랩하기
      description: 요청한 유저의 스크랩 목록에 기사를 추가합니다. (세션 기반 인증)
      tags:
        - Mypage
      operationId: addScrapedArticles
      parameters:
        - name: article_id
          in: query
          description: 추가할 기사 id
          required: true
          schema: 
            type: integer
      responses:
        '200':
          description: 스크랩 성공
    delete:
      summary: 마이페이지 - 스크랩한 기사 삭제
      description: 요청한 유저가 스크랩한 기사를 삭제합니다. 스크랩 목록에 해당 기사가 없다면 아무것도 하지 않습니다. (세션 기반 인증)
      tags:
        - Mypage
      operationId: deleteScrapedArticles
      parameters:
        - name: article_id
          in: query
          description: 삭제할 기사 id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 삭제 성공

  /mypage/recent:
    get:
      summary: 마이페이지 - 최근 본 기사 목록
      description: 요청한 유저가 최근에 본 기사 리스트를 반환합니다.
      tags:
        - Mypage
      operationId: getRecentArticles
      responses:
        '200':
          description: 최근 본 기사 목록 반환
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Article'
                  
  /util/word-meaning:
    get:
      summary: 단어의 의미 질문
      description: 문장 내에서 단어의 의미를 gemini에게 질문합니다.
      tags:
        - Util
      operationId: getWordMeaning
      parameters:
        - name: word
          in: query
          description: 질문할 단어
          required: true
          schema:
            type: string
        - name: sentence
          in: query
          description: 단어의 맥락 이해를 위해 해당 단어가 포함된 문장 전체
          required: true
          schema: 
            type: string
      responses: 
        '200':
          description: 문장 내에서 단어의 의미에 대한 설명 반환
          content: 
            text/plain:
              schema: 
                type: string
                example: "이 문장에서 해당 단어는 별 의미가 없을 확률이 높습니다. 무시하셔도 됩니다."

components:
  schemas:
    LoginRequest:
      type: object
      properties:
        id:
          type: string
          description: 사용자 ID
          example: "user123"
        pw:
          type: string
          description: 사용자 비밀번호
          example: "mypassword"
      required:
        - id
        - pw

    Article:
      type: object
      description: 기사 정보 DTO
      properties:
        id:
          type: integer
          description: 기사 고유 ID
          example: 12
        category:
          type: string
          description: 기사 카테고리
          example: "politics"
        date:
          type: string
          format: date
          description: 기사 작성일 (YYYY-MM-DD)
          example: "2024-01-02"
        url:
          type: string
          description: 원본 기사 URL
          example: "https://news.example.com/12"
        title:
          type: string
          description: 기사 제목
          example: "정부, 새로운 정책 발표"
        content:
          type: string
          nullable: true
          description: 기사 원문 (세부 조회 시 제공 될 수 있음)
        simplified:
          type: string
          nullable: true
          description: AI 해석본
          example: "정부가 새로운 정책을 발표했습니다. 주요 내용은..."
        summary:
          type: string
          nullable: true
          description: AI 요약본
          example: "정부는 오늘 새로운 정책을 발표했다."